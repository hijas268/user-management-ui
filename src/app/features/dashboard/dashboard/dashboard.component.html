<div class="container dashboard-container mt-4">
  <h2>User Management</h2>

  <!-- Add User Form -->
  <div class="form-section mb-4">
    <h3>Add User</h3>
    <div class="row g-2">
      <div class="col-md-3">
        <input type="text" class="form-control" placeholder="Username" [(ngModel)]="newUser.username" />
      </div>
      <div class="col-md-3">
        <input type="email" class="form-control" placeholder="Email" [(ngModel)]="newUser.email" />
      </div>
      <div class="col-md-3">
        <select class="form-select" [(ngModel)]="newUser.role">
          <option value="User">User</option>
          <option value="Admin">Admin</option>
          <option value="ReadOnlyUser">ReadOnlyUser</option>
        </select>
      </div>
      <div class="col-md-3">
        <button class="btn btn-primary" (click)="addUser()">Add</button>
      </div>
    </div>
  </div>

  <!-- Edit User Form -->
  <div *ngIf="selectedUser" class="form-section mb-4">
    <h3>Edit User</h3>
    <div class="row g-2">
      <div class="col-md-3">
        <input type="text" class="form-control" [(ngModel)]="selectedUser.username" placeholder="Username" />
      </div>
      <div class="col-md-3">
        <input type="email" class="form-control" [(ngModel)]="selectedUser.email" placeholder="Email" />
      </div>
      <div class="col-md-3">
        <select class="form-select" [(ngModel)]="selectedUser.role">
          <option value="User">User</option>
          <option value="Admin">Admin</option>
          <option value="ReadOnlyUser">ReadOnlyUser</option>
        </select>
      </div>
      <div class="col-md-3 d-flex gap-2">
        <button class="btn btn-success flex-fill" (click)="updateUser()">Update</button>
        <button class="btn btn-secondary flex-fill" (click)="resetForm()">Cancel</button>
      </div>
    </div>
  </div>
<hr />
<br>
  <!-- Search & Filter -->
  <div class="filter-bar mb-3 row g-2">
    <div class="col-md-6">
      <input type="text" class="form-control" placeholder="Search by username/email" [(ngModel)]="searchTerm" (ngModelChange)="loadUsers()" />
    </div>
    <div class="col-md-3">
      <select class="form-select" [(ngModel)]="roleFilter" (change)="loadUsers()">
        <option value="">All Roles</option>
        <option value="Admin">Admin</option>
        <option value="User">User</option>
        <option value="ReadOnlyUser">ReadOnlyUser</option>
      </select>
    </div>
  </div>

  <!-- User Table -->
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th>Username</th>
        <th>Email</th>
        <th>Role</th>
        <th>Created</th>
        <th>Last Modified</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of users">
        <td>{{ user.username }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.role }}</td>
        <td>{{ user.createdAt | date: 'short' }}</td>
        <td>{{ user.lastModifiedAt | date: 'short' }}</td>
        <td class="d-flex gap-2">
          <button class="btn btn-sm btn-primary" (click)="editUser(user)">Edit</button>
          <button class="btn btn-sm btn-danger" (click)="deleteUser(user.id)">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
